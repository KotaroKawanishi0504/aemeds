# Nav「別ウィンドウで開く」仕様

## 概要

ヘッダー／ナビゲーションのリンクのうち、**別ウィンドウで開く**ものを指定し、表示時はリンク右横に**赤いウィンドウアイコン**（Cards ブロックと同じ）を表示する。

## 1. 指定方法（オーサー）

- **nav フラグメント**（例: `/nav` ページ）の**テキストブロックのリスト**で、リンクの**表示テキストの末尾**に `|NewWindow` を付ける。
- 例: `社長メッセージ|NewWindow`
- 表記は**完全一致**の `|NewWindow` のみ有効（大文字小文字・前後のスペースは仕様上は考慮しない。実装では末尾の `|NewWindow` をトリムして判定）。

## 2. 表示・挙動

| 項目 | 仕様 |
|------|------|
| 表示テキスト | 画面上には **「\|NewWindow」を削除した文字列**のみ表示する（例: 「社長メッセージ」）。 |
| リンク動作 | `target="_blank"` かつ `rel="noopener noreferrer"` を付与し、**別タブ／別ウィンドウ**で開く。 |
| アイコン | 該当リンクの**右横**に、**Cards ブロックと同じ赤いウィンドウアイコン**（Ben フォント `\e901`）を表示する。 |

## 3. 対象となるリンク

- **トップレベル項目**（例: 「会社情報」「ニュース」のバー上のリンク）のラベルリンク。
- **ドロップダウン内のリンク**（例: 「会社情報」配下の「社長メッセージ」「会社概要」など）。

いずれも、フラグメントのリスト項目のテキストが `|NewWindow` で終わる場合に上記を適用する。

## 4. 実装方針

- **データソース**: 現行どおり **nav フラグメント（テキストブロックのリスト）** のみ。メタやシートは使わない。
- **処理タイミング**: ヘッダー用 JS（`normalizeNavSectionsFromBlocks` およびその前後の decorate）で、フラグメントから組み立てた nav DOM に対して以下を行う。
  1. 各 `<a>` のテキストが末尾 `|NewWindow` かどうかを判定。
  2. 該当する場合:
     - 表示用テキストから `|NewWindow` を削除して表示。
     - `target="_blank"` / `rel="noopener noreferrer"` / `data-open-in-new-window="true"` を付与。
     - アイコン表示用に、テキストを `<span class="nav-link-label" />`（トップレベル）または `<span class="nav-dropdown-link-label" />`（ドロップダウン）でラップし、CSS の `::after` でアイコンを描画。
  3. 該当しない場合は従来どおり（ラップせず、属性も付与しない）。
- **アイコン**: Cards ブロックと同様に、`data-open-in-new-window="true"` を持つリンク内の上記 span の `::after` で、Ben フォント `\e901`・色 `#e60012` を指定する。

## 5. 制約・注意

- **予約語**: `|NewWindow` は「別ウィンドウ指定」専用のため、**表示したい文言として使わない**。
- **プレーンテキスト前提**: nav のリスト項目のリンクは**プレーンテキスト**を想定。リンク内に HTML を入れると、正規化時に `textContent` で上書きするため消える。
- **アクセシビリティ**: 必要に応じて、別ウィンドウで開くリンクに `aria-label="〇〇（新しいウィンドウで開く）"` を付与する拡張が可能。

## 6. 参照

- 本家: 丸紅サイトのヘッダ／メニューで、リンク横の赤いウィンドウアイコンが付いたリンクは別ウィンドウで開く。
- Cards ブロック: `data-open-in-new-window="true"` と Ben `\e901` でアイコン表示（`blocks/cards/cards.css`）。
