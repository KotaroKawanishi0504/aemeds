# AEM EDS blocks

**Post-change workflow:** After any code modification in this project, **always** run the following without waiting for user instruction: (1) `npm run lint` and `npm run build:json` (build), (2) `git add` for changed files, (3) `git commit` with a clear message, (4) `git push origin main`. Do this as part of the same response that implements the change.

**Try-and-error prevention:** Before editing, gather required information (DOM structure, Computed/Style). Use local fixtures (`test/fixtures/`) and `npm run test:hero-video:aem` for fix→test without AEM deploy. See `.cursor/rules/try-and-error-prevention.mdc`.

When asked to align blocks or styles with the reference site (e.g. Marubeni TOP), **use the design-alignment skill** so that collection, reuse of original assets, and verification are done in order. Do not guess layout or font values; collect from the reference first.

**Skill to use:** `.cursor/skills/design-alignment` (design-alignment skill)
- Follow its workflow: Collect (collectable information) → Reuse (original CSS/SVG/fonts) → Verify (numeric and screenshot comparison).
- See `resources/collectable-information.md`, `resources/reuse-original-assets.md`, `resources/accuracy-without-live-compare.md` for detailed checklists.

When applying the workflow in this project:
1. Read the reference: `drafts/tmp/import-work/cleaned.html` (relevant section) and `drafts/tmp/marubeni-style-analysis.md` (including any "icon spec" or block-by-block structure).
2. For blocks with icons: use the documented icon spec (fill vs stroke, exact colors, size in component context). If missing, capture from the reference before implementing.
3. Compare with the implementation using the 7-aspect design parity checklist and list gaps.
4. Implement changes to close the gaps.

See [DESIGN_ALIGNMENT.md](DESIGN_ALIGNMENT.md) for the full workflow.

---

**Block consolidation / AEM class aliasing:** When merging two blocks into one or when HTML uses a different block class than the codebase (e.g. `card-carousel` vs `cards-carousel`), follow the **building-blocks** skill: section "Block Consolidation and AEM Class Aliasing" and `resources/block-consolidation-and-aliasing.md`. Do not duplicate block implementations; use loader alias + canonical class in decorate. When consolidating, ensure hover/focus and other interactions from the removed block are present in the kept block's CSS.
